# Chapter 17: Consistency (일관성)

## 핵심 질문

일관성이 소프트웨어 복잡성에 어떤 영향을 미치는가? 어떻게 일관성을 확보하고 유지할 수 있는가?

---

## 1. 왜 일관성이 중요한가

> **일관성은 인지 부하를 줄이는 가장 쉬운 방법 중 하나다.**

한 가지 패턴을 배우면 같은 패턴이 적용된 모든 곳을 이해할 수 있다. 일관성이 없으면 각 사례를 개별적으로 학습해야 한다.

```python
# 일관적: 한 패턴을 배우면 됨
def create_user(data): ...    # 생성
def create_order(data): ...   # 같은 패턴
def create_product(data): ... # 같은 패턴

# 비일관적: 각각 별도로 학습해야 함
def create_user(data): ...
def new_order(data): ...      # 다른 동사
def add_product(data): ...    # 또 다른 동사
```

---

## 2. 일관성의 유형

| 유형 | 설명 | 예시 |
|------|------|------|
| **이름** | 같은 것은 항상 같은 이름 | `count` vs `num` vs `total` 혼용하지 않기 |
| **코딩 스타일** | 들여쓰기, 중괄호, 공백 | 프로젝트 전체에서 동일한 스타일 |
| **인터페이스** | 유사한 연산의 시그니처 | CRUD 메서드의 파라미터 순서 |
| **설계 패턴** | 같은 문제에 같은 패턴 | 에러 처리 방식, 로깅 방식 |
| **불변 조건** | 데이터의 일관된 속성 | "이 리스트는 항상 정렬되어 있다" |

---

## 3. 일관성을 확보하는 방법

### 3.1 규칙을 문서화하라

코딩 컨벤션을 명시적으로 문서화하고 팀 전체가 따르도록 한다.

### 3.2 도구로 강제하라

- **Linter/Formatter**: 코딩 스타일 자동 강제
- **정적 분석**: 패턴 위반 감지
- **CI/CD**: 규칙 위반 시 빌드 실패

### 3.3 코드 리뷰에서 확인하라

리뷰어는 기능 정확성뿐 아니라 **기존 컨벤션과의 일관성**도 확인해야 한다.

### 3.4 기존 관례를 따르라

> **"When in Rome, do as the Romans do."**

새 코드를 작성할 때는 기존 코드베이스의 패턴을 따른다. 자신만의 "더 나은" 스타일을 도입하면 일관성이 깨진다.

```python
# 기존 코드가 이 패턴을 사용한다면
def get_user_by_id(user_id: str) -> Optional[User]: ...
def get_order_by_id(order_id: str) -> Optional[Order]: ...

# 새 코드도 같은 패턴을 따른다
def get_product_by_id(product_id: str) -> Optional[Product]: ...

# 이렇게 하지 않는다 (일관성 위반)
def find_product(id: str) -> Product | None: ...
```

---

## 4. 일관성을 깨는 것이 허용되는 경우

정말로 **기존 방식보다 명확히 나은 새로운 방식**이 있다면 변경할 수 있다. 하지만:

- 기준이 높아야 한다 (단순한 선호가 아니라 명확한 개선이어야)
- 팀의 동의를 얻어야 한다
- 가능하면 기존 코드도 함께 마이그레이션한다
- 변경 이유를 문서화한다

---

## 요약

- **일관성**은 인지 부하를 줄이는 강력한 도구다.
- 이름, 코딩 스타일, 인터페이스, 설계 패턴, 불변 조건 등 모든 수준에서 일관성을 유지하라.
- 규칙을 **문서화**하고, **도구로 강제**하고, **코드 리뷰에서 확인**하라.
- 기존 관례를 따르라: **"When in Rome, do as the Romans do."**
- 일관성을 깨려면 높은 기준과 팀 동의가 필요하다.

---

## 다음 챕터와의 연결

Chapter 18 **"Code Should be Obvious (코드는 명확해야 한다)"** 에서는 일관성을 포함한 여러 기법이 어떻게 코드의 **명확성(obviousness)** 에 기여하는지, 그리고 코드를 불명확하게 만드는 흔한 패턴을 다룬다.
